#! /bin/sh -x
# mme getpac yast2-network sp1

# fd3 will be our output, stdout goes stderr
exec 3>&1 >&2

set -o errexit
PKG=$1
SHORT_PRJ=$2
shift 2

API=https://api.suse.de

case ${SHORT_PRJ-sp1} in
    factory)
        API=https://api.opensuse.org
        PRJ=openSUSE:Factory
        ;;
    114)
        API=https://api.opensuse.org
        PRJ=openSUSE:11.4:Update:Test
        ;;
    sp1)
        PRJ=SUSE:SLE-11-SP1:Update:Test
        ;;
    sp2)
        PRJ=SUSE:SLE-11-SP2:GA
        ;;
    sle10sp3)
        PRJ=SUSE:SLE-10-SP3:Update:Test
        ;;
    *)
        echo missing case \'$SHORT_PRJ\' in $0
        exit 1
        ;;
esac
: ${OSC_USER=$LOGNAME}
cd ~
DEVEL_PRJ=`osc -A $API develproject $PRJ $PKG`
case $DEVEL_PRJ in
    *has?no?devel?project)
        DEVEL_PRJ=$PRJ
        ;;
esac
OSC_WORK=~/"home:$OSC_USER:branches:$DEVEL_PRJ"/$PKG
osc -A $API bco $DEVEL_PRJ $PKG || test -d $OSC_WORK

echo >&3 $OSC_WORK
